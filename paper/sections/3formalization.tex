\section{Formalization}
\label{sec:formalization}

\subsection{American Call Option}

The American Call Option is a contract that ``one can buy an amount of an asset with an agreed price prior to or on an agreed time in the future''.
The agreed price is usually called the \textit{spot price}, and the buying is called \textit{exercising}.
For American Call Option, the buyer can exercise in advanced of the agreed exercise time.
The price of the asset when exercising is called the \textit{strike price}.
Apart from the asset, the option contract itself has value, called the \textit{premium}.
The buyer should pay for both the asset and the premium when participating in the contract.

Note that the price of the asset changes over time. This makes the American Call Option ``speculative'': One may profit from the contract by buying the asset with a lower price then sell it with a higher price.

We define an American Call Option contract $\Pi$ as $(K, \pi_1, y, \pi_2, S, T, pr)$.
$K$ is the strike price - the amount of the currency $\pi_1$ that the buyer needs to pay.
$y$ is the amount of the asset $\pi_2$ that the seller wants to sell.
$S_t$ is the price of a unit of $\pi_2$ against the time $t$.
$T$ is the agreed strike time.
$pr$ is the \textit{premium}.

\begin{enumerate}
    \item \textbf{Advertise}: The buyer creates and advertises an American Call Option contract $\Pi = (K, \pi_1, y, \pi_2, S, T, pr)$.
    \item \textbf{Contract}: The seller finds $\Pi$ is profitable, so he signs $\Pi$.
    The buyer should pay $pr$ to the seller.
    Note that the buyer does not pay for $\pi$ at this stage.
    \item \textbf{Hold}: The buyer keeps not exercising $\Pi$. If he doesn't exercise $\Pi$ before $T$, $\Pi$ will abort.
    \item \textbf{Exercise}: The buyer exercises $\Pi$ - The buyer pays $K$ $\pi_1$ to the seller, and the seller gives $y$ $\pi_2$ to the buyer. The buyer can exercise $\Pi$ before $T$ or on $T$.
\end{enumerate}

\subsection{Atomic Cross-Chain Swap}

Alice hopes to buy $x_2$ $Coin_2$ on blockchain $BC_2$ with $x_1$ $Coin_1$ on blockchain $BC_1$.
She initiates an atomic swap, and Bob participates in the atomic swap.
We define an Atomic Swap $\mathcal{AS}$ as $(x_1, Coin_1, x_2, Coin_2)$.

The Atomic Swap protocol consists of the algorithms below:

\begin{enumerate}
    \item \textbf{Setup}: Alice and Bob create addresses on both blockchains.
    \item \textbf{Initiate}: Alice initiates the Atomic Swap by publishing a contract transaction on $BC_1$.
    \item \textbf{Participate}: Bob participates in the Atomic Swap by publishing a contract transaction on $BC_2$.
    \item \textbf{Redeem}: Alice redeems $x_2$ $Coin_2$ and Bob redeems $x_1$ $Coin_1$. Alice should redeem earlier than Bob.
    \item \textbf{Refund}: If Alice or Bob is unsatisfied with the Atomic Swap, he/she can get his/her money back after the timelock of the contract transaction.
\end{enumerate}

\paragraph{Setup}
takes the security parameter $k$,
and returns the address on two blockchains for Alice and Bob $\beta_{A, 1}$, $\beta_{A, 2}$, $\beta_{B, 1}$, $\beta_{B, 2}$.

\paragraph{Initiate}
takes $\beta_{B, 1}$ and $x_1$,
and returns the preimage $s$, the preimage hash $h$, the contract script $\mathcal{C}_1$, the contract transaction $tx_{\mathcal{C}, 1}$, the refund script $\mathcal{R}_1$, and the refund transaction $tx_{\mathcal{R}, 1}$.
The preimage $s$ is a random string generated by Alice. At this stage, $s$ is only known to Alice.
The preimage hash $h = H(s)$, where $H$ is a cryptographic hash function.  $h$ is published when Initiate.
The contract script $\mathcal{C}_1$ is that ``Alice pays $x_1$ $Coin_1$ from $\beta_{A, 1}$ to $\beta_{B, 1}$ if Bob can provide $s$ before or on a timelock $\Delta_1$ (which is a timestamp). After $\Delta_1$, Alice can refund the money - get $x_1$ $Coin_1$ back.''
The contract script is published as a transaction $tx_{\mathcal{C}, 1}$ on $BC_1$ when Initiate.
The refund script $\mathcal{R}_1$ is that ``Alice pays $x_1$ $Coin_1$ from $\beta_{A, 1}$ to her another address.'' This is to ensure $x_1$ $Coin_1$ can no longer be redeemed by others. Alice can do this only after $\Delta_1$.
The refund is done by publishing $\mathcal{R}_1$ as a transaction $tx_{\mathcal{R}, 1}$ on $BC_1$ if Alice can and decide to refund.

\paragraph{Participate}
takes $\beta_{A, 2}$, $x_2$ and $h$,
and returns the contract script $\mathcal{C}_2$, the contract transaction $tx_{\mathcal{C}, 2}$, the refund script $\mathcal{R}_2$, and the refund transaction $tx_{\mathcal{R}, 2}$.
The contract script $\mathcal{C}_2$ is that ``Bob pays $x_2$ $Coin_2$ from $\beta_{B, 2}$ to $\beta_{A, 2}$ if Alice can provide $s$ before or on a timelock $\Delta_2$ (which is a timestamp). After the time of $\Delta_2$, Bob can refund the money - get $x_2$ $Coin_2$ back.''
Here $\Delta_2$ should expire earlier than $\Delta_1$.
The contract script is published as a transaction $tx_{\mathcal{C}, 2}$ on $BC_2$ when Initiate.
The refund script $\mathcal{R}_2$ is that ``Bob pays $x_2$ $Coin_2$ from $\beta_{B, 2}$ to his another address.'' This is to ensure $x_2$ $Coin_2$ can no longer be redeemed by others. Bob can do this only after $\Delta_2$.
The refund is done by publishing $\mathcal{R}_2$ as a transaction $tx_{\mathcal{R}, 2}$ on $BC_2$ if Bob can and decide to refund.

\paragraph{Redeem}
takes $s$,
and returns $\mathcal{V} \in \{true, false\}$ indicating if the redemption is successful or not.
The redemption can be performed by both parties, and Alice should redeem earlier than Bob.
As Alice knows $s$, she can redeem $x_2$ $Coin_2$ - pay $x_2$ $Coin_2$ in $\beta{A, 2}$ to her another address by attaching $s$ in this transaction.
After Alice redeems $x_2$ $Coin_2$, $s$ is published, so that Bob can redeem $x_1$ $Coin_1$, similarly.

\paragraph{Refund}
takes no parameters and returns the $\mathcal{V} \in \{true, false\}$ indicating if the refund is successful or not.
Alice and Bob can perform the refund by publishing $tx_{\mathcal{R}, 1}$ and $tx_{\mathcal{R}, 2}$ after the timelock $\Delta_1$ and $\Delta
_2$, respectively.

\subsection{Modelling the Atomic Cross-Chain Swap as the American Call Option}

We model the Atomic Cross-Chain Swap protocol as the American Call Option.
In detail, the Atomic Cross-Chain Swap protocol is equivalent to a premium-free American Call Option.

Assume Alice \textbf{initiates} an Atomic Cross-Chain Swap $\mathcal{AS} = (x_1, Coin_1, x_2, Coin_2)$ and Bob \textbf{participates} $\mathcal{AS}$.

\begin{theorem}
$\mathcal{AS} = (x_1, Coin_1, x_2, Coin_2)$ is equivalent to the American Call Option contract

$$
\Pi = (\frac{x_2 Coin_2}{Coin_1}, Coin_1, x_2, Coin_2, \frac{Coin_2}{Coin_1}, \Delta_2, 0)
$$
\end{theorem}

\begin{proof}
% model the atomic swap as aco
In the American Call Option context, the buyer Alice wants to buy $x_2$ $Coin_2$ from the participant Bob by using $x_1$ $Coin_1$.
$Coin_1$ is the currency Alice uses, $Coin_2$ is the asset Bob has.
$\frac{Coin_2}{Coin_1}$ is the price of the asset from Alice's perspective.
Alice needs to pay for the strike price $K = \frac{x_2 Coin_2}{Coin_1}$, of which the value is equal to $x_2 Coin_2$ in the Atomic Cross-Chain Swap scenario.
$\Delta_2$ is the timelock of the contract transaction on $BC_2$.
It is equivalent to the strike time of $\Pi$, because after $\Delta_2$ Bob can refund his asset back.
Establishing the Atomic Swap does not require Alice to pay anything other than the asset to Bob, so the premium here is zero.
\end{proof}

Recall that the premium is the price paid by the buyer for signing the option contract with the seller.
It is the price for the seller to take the risk of the market.
However, in the Atomic Cross-Chain Swap case, Alice is not required to pay for the premium.
That is, Alice can losslessly choose to sign, exercise or abort the contract according to the market, but Bob can only follow Alice's decision while taking the risk of the market.
Therefore, the premium-free American Call Option is unfair to the seller, and the Atomic Cross-Chain Swap is unfair to the participant.

% The components of an option premium include its intrinsic value, its time value and the implied volatility of the underlying asset.